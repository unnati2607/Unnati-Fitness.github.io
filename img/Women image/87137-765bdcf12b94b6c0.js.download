"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[87137],{6733:function(t,e,r){r.d(e,{dv:function(){return u},h2:function(){return l},Xq:function(){return d},FB:function(){return m},bw:function(){return f},nS:function(){return p},ZQ:function(){return v},AN:function(){return b},Hf:function(){return h},_W:function(){return g},mW:function(){return y},Pf:function(){return P}});var n=r(92809),a=r(11987),i=r(27349);function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){(0,n.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var s=function(t){var e=t.urlParams,r=void 0===e?{}:e,n=t.queryParams,o=void 0===n?{}:n,s="/cart/".concat(r.isPrimary?i.Yl:i.d7),u=c({},o);return{url:s,defaultParams:u,formattedUrl:(0,a.format)({pathname:s,query:u})}},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.urlParams,r=void 0===e?{}:e,n=t.queryParams,i=void 0===n?{}:n,o=s({urlParams:r,queryParams:i}),u=c({},o.defaultParams);return c(c({},o),{},{defaultParams:u,formattedUrl:(0,a.format)({pathname:o.url,query:u})})},l=s,d=s,m=function(t){var e=t.urlParams,r=void 0===e?{}:e,n=t.queryParams,i=void 0===n?{}:n,o="/cart/".concat(r.fromCartType,"/to/").concat(r.toCartType),s=c({},i);return{url:o,defaultParams:s,formattedUrl:(0,a.format)({pathname:o,query:s})}},f=function(t){var e=t.urlParams,r=void 0===e?{}:e,n="/organization/".concat(r.organizationId,"/invitations/").concat(r.status);return{url:n,formattedUrl:(0,a.format)({pathname:n})}},p=function(t){var e=t.urlParams,r="/account/user/".concat((void 0===e?{}:e).id,"/settings");return{url:r,formattedUrl:(0,a.format)({pathname:r})}},v=function(t){var e=t.urlParams,r="/account/user/".concat((void 0===e?{}:e).id,"/settings");return{url:r,formattedUrl:(0,a.format)({pathname:r})}},b=function(t){var e=t.urlParams,r=void 0===e?{}:e,n="/organization/".concat(r.organizationId,"/invitations/").concat(r.invitationId);return{url:n,formattedUrl:(0,a.format)({pathname:n})}},h=function(t){var e=t.urlParams,r="/organization/".concat((void 0===e?{}:e).organizationId,"/invitations");return{url:r,formattedUrl:(0,a.format)({pathname:r})}},g=function(t){var e=t.urlParams,r="/organization/users/".concat((void 0===e?{}:e).id);return{url:r,formattedUrl:(0,a.format)({pathname:r})}},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.urlParams,r=void 0===e?{}:e,n=t.queryParams,i=void 0===n?{}:n,o="/finance/accounts/".concat(r.accountId,"/billing-entities"),s=c({},i);return{url:o,defaultParams:s,formattedUrl:(0,a.format)({pathname:o,query:s})}},P=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.queryParams,r=void 0===e?{}:e,n="/cart/".concat(i.Yl,"/quote"),o=c(c({},r),{},{exclude_comps:1,expand:"agreements"});return{url:n,defaultParams:o,formattedUrl:(0,a.format)({pathname:n,query:o})}}},87137:function(t,e,r){r.d(e,{kC:function(){return F},D9:function(){return R},gV:function(){return V},GH:function(){return M},Z4:function(){return N}});var n=r(91164),a=r(30266),i=r(86818),o=r(92809),c=r(809),s=r.n(c),u=r(11163),l=r(67294),d=r(40821),m=r(6733),f=r(81391),p=r(16257),v=r(39338),b=r(87883),h=r(27349),g=r(77573),y=r(93126),P=r(65014),w=r(60996),I=r(20559),C=r(52087),O=r(48483),j=r(68733),k=r(95101),x=r(61565),S=r(87686);function T(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function L(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?T(Object(r),!0).forEach((function(e){(0,o.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var _=r(82674),A=r(42926),D=r(28302),U=r(54887),E=["isLoading"];function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function B(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(r),!0).forEach((function(e){(0,o.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var q="Size limit warning",z=function(t){var e,r=t.asset;return r.itemType===b.k4&&!r.sizes&&!(null!==(e=r.metadata)&&void 0!==e&&e.cart.sizes)},R=function(t){var e=t.cartItems,r=void 0===e?[]:e,n=t.subscriptions;return r.filter((function(t){return[b.k4,b.pX,b.j0,b.gP,b.cF].includes(t.itemType)})).map((function(t){var e,r,a,i,c,s,u,l,d,m,f,p,h,g,w=function(t){var e=t.item,r=t.subscriptions,n=e.itemType,a=e.metadata,i=(0,C.Qo)({asset:e}),o=null===a||void 0===a?void 0:a.cart.licenseId,c=r.allSubscriptions;switch(n){case b.pX:return(0,O.eL)({licenseName:o,subscriptions:c});case b.j0:case b.k4:default:return(0,O.$L)({licenseName:o,subscriptions:c,assetType:n,contentTier:i})}}({item:t,subscriptions:n}),I=function(t){var e,r,n=t.item;return(null===(e=n.largeThumb)||void 0===e?void 0:e.url)||(null===(r=n.preview)||void 0===r?void 0:r.url)||n.preview||n.thumb||""}({item:t}),j=null===(e=t.meta)||void 0===e?void 0:e.search_context;null!==(r=t.metadata)&&void 0!==r&&null!==(a=r.cart)&&void 0!==a&&a.searchContext&&(j=(0,P.Be)({trackingId:null===(d=t.metadata)||void 0===d||null===(m=d.cart)||void 0===m||null===(f=m.searchContext)||void 0===f?void 0:f.searchTrackingId,searchTerm:null===(p=t.metadata)||void 0===p||null===(h=p.cart)||void 0===h||null===(g=h.searchContext)||void 0===g?void 0:g.searchTerm}));return B(B(B({},t),{},{id:t.itemId},[b.k4,b.gP,b.cF].some((function(e){return e===t.itemType}))&&{image:{id:t.itemId,categories:t.categories,description:t.description||t.subhead||"",url:I.replace("-150nw","-260nw"),isEditorial:!!t.isEditorial,isPremium:!!t.isPremium,displays:(0,o.Z)({},v.RA,{height:(null===(i=t.largeThumb)||void 0===i?void 0:i.height)||(null===(c=t.preview)||void 0===c?void 0:c.height),width:(null===(s=t.largeThumb)||void 0===s?void 0:s.width)||(null===(u=t.preview)||void 0===u?void 0:u.width)}),permalink:t.permalink,isIllustration:t.isIllustration,isVector:t.isVector}}),{},{type:t.itemType,isFootageSelect:t.footageSelect,price:(null===w||void 0===w?void 0:w.creditPrice)||0,priceType:(null===w||void 0===w?void 0:w.creditType)||y.Zm,currency:(null===w||void 0===w?void 0:w.creditCurrency)||"",licenseId:(null===(l=t.metadata)||void 0===l?void 0:l.cart.licenseId)||"",subscriptionId:(null===w||void 0===w?void 0:w.id)||"-",hasCreditsRemaining:(0,O.rZ)({subscription:w}),isUnavailableAsset:z({asset:t}),isUnlimited:(0,O.qY)({subscription:w}),meta:B({},j?{search_context:j}:{})})}))},F=function(t){var e=t.isPrimary;return(0,m.dv)({urlParams:{isPrimary:e}}).formattedUrl},M=function(t){var e=t.isPrimary,r=(0,U.B)(),n=(0,_.av)().data;return(0,d.ZP)(r&&n?F({isPrimary:e}):null,(function(t){return D.jm.get(t).then((function(t){var e=t.data;return e&&B(B({},e),{},{items:R({cartItems:e.items,subscriptions:n})})}))}))},V=function(){var t=(0,l.useState)({status:"",error:void 0}),e=t[0],r=t[1],n=(0,l.useState)(!1),o=n[0],c=n[1],v=(0,l.useRef)(!1),y=function(){var t=(0,S.yh)().analytics,e=(0,k.Y)().getSearchContext,r=(0,l.useCallback)((function(e){var r=e.cartId,n=(e.items||[]).map((function(t,e){return(0,P.zm)({asset:t,cartId:r,index:e})})),a=n.reduce((function(t,e){return{totalPrice:t.totalPrice+Number(e.price),toBeBilled:t.toBeBilled+1}}),{totalPrice:0,toBeBilled:0});t.cartViewed({products:n,cartId:r,cartTotal:Math.round(100*a.totalPrice)/100,numItemsBilledToCard:a.toBeBilled,shouldCheckout:a.totalPrice>0,shouldDownload:n.length>0&&0===a.totalPrice})}),[t]);return{productAddedAnalyticsEvent:(0,l.useCallback)((function(r){var n=r.cart,a=r.eventLabel,i=r.gridItems,o=r.items,c=r.licenseId,s=r.licensePrice,u=r.listId,l=r.pageSection;t.productAdded({products:o.map((function(t){return(0,P.bR)({asset:t,cartData:n,getSearchContext:e,gridItems:i,licenseId:c,licensePrice:s,pageSection:l})})),eventLabel:a,list_id:null!==u&&void 0!==u?u:""})}),[t,e]),productRemovedAnalyticsEvent:(0,l.useCallback)((function(r){var n=r.cart,a=r.eventLabel,i=r.gridItems,o=r.items,c=r.listId,s=r.matchingCartItem,u=r.pageSection;if(s){var l=(0,x.Z)(o,1)[0];t.productRemoved(L(L({},(0,P.bR)({asset:l,cartData:n,getSearchContext:e,gridItems:i,pageSection:u})),{},{price:s.price,variant:s.licenseId,eventLabel:a,list_id:null!==c&&void 0!==c?c:""}))}else t.productRemoved({products:o.map((function(t){return(0,P.bR)({asset:t,cartData:n,getSearchContext:e,gridItems:i,pageSection:u})})),eventLabel:a,list_id:null!==c&&void 0!==c?c:""})}),[t,e]),cartViewedAnalyticsEvent:r}}(),C=y.productAddedAnalyticsEvent,O=y.cartViewedAnalyticsEvent,j=y.productRemovedAnalyticsEvent,T=(0,k.Y)().getSearchContext,_=(0,u.useRouter)(),A=(0,l.useCallback)((function(t){"undefined"===typeof(null===t||void 0===t?void 0:t.cartId)||v.current||(v.current=!0,O(t))}),[v,O]),U=(0,l.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.filter((function(t){var r=t.id;return-1===e.findIndex((function(t){var e=t.id;return r===e}))}))}),[]),E=(0,l.useCallback)((function(t){var e=t.cartItems,r=void 0===e?[]:e,n=t.itemsToAdd,a=void 0===n?[]:n,o=(0,i.Z)(r);return a.forEach((function(t){var e=(0,w.rw)({asset:t}),r=o.findIndex((function(r){var n=r.id,a=r.type;return n===t.id&&a===e}));r>-1?o[r]=B({},t):o.unshift(B({},t))})),o}),[]),Z=(0,l.useCallback)(function(){var t=(0,a.Z)(s().mark((function t(e){var r,n,i,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.items,n=e.licenseId,i=e.licenseAsJpeg,o=null===r||void 0===r?void 0:r.map(function(){var t=(0,a.Z)(s().mark((function t(e){var r,a,o,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(0,w.rw)({asset:e}),a=n||e.licenseId,o=i||e.licenseAsJpeg,t.next=5,(0,I.Oo)({asset:e,licenseName:a});case 5:return c=t.sent,t.abrupt("return",{item_id:e.id,item_type:r,metadata:{cart:{license_id:a,license_as_jpeg:o,subscription_id:e.subscriptionId,size:c.content_size,format:c.content_format,sizes:(0,I.rB)({asset:e}),search_context:T(e),source:[b.gP,b.cF].some((function(t){return t===r}))?g._e:""}}});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.abrupt("return",Promise.all(o));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[T]);return{triggerCartViewedEvent:A,addCartItems:(0,l.useCallback)(function(){var t=(0,a.Z)(s().mark((function t(e){var n,a,i,o,u,l,v,b,g,y,P,w,I,O,k,x,S;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.cart,a=e.eventLabel,i=e.gridItems,o=e.isPrimary,u=void 0===o||o,l=e.itemsToAdd,v=e.licenseId,b=e.formatType,g=e.licensePrice,y=e.mutateCart,P=e.withOptimisticUpdate,w=void 0===P||P,I=e.pageSection,O=e.listId,t.prev=1,k=l.map((function(t){return B(B({},t),{},{meta:B({search_context:T(t)},t.meta)})})),r({status:"",error:void 0}),c(!1),!((x=E({cartItems:n.items,itemsToAdd:k})).length>h.fv)){t.next=10;break}return r({status:f.cM}),c(!0),t.abrupt("return");case 10:return w&&y((function(t){return B(B({},t),{},{items:x})}),!1),S=(0,m.Xq)({urlParams:{isPrimary:u}}).formattedUrl,t.t0=D.jm,t.t1=S,t.next=16,Z({items:k,licenseId:v,licenseAsJpeg:b===p._3});case 16:return t.t2=t.sent,t.next=19,t.t0.post.call(t.t0,t.t1,t.t2);case 19:r({status:f.MR}),u&&k.forEach((function(t){var e=n.items.find((function(e){return e.id===t.id}));e&&v!==e.licenseId&&j({cart:n,eventLabel:a,gridItems:i,items:[t],matchingCartItem:e,pageSection:I}),C({cart:n,eventLabel:a,gridItems:i,items:[t],licenseId:v,licensePrice:g,pageSection:I,listId:O})})),t.next=26;break;case 23:t.prev=23,t.t3=t.catch(1),r({status:f.cM,error:t.t3});case 26:return t.prev=26,t.next=29,(0,d.JG)(F({isPrimary:u}));case 29:return t.finish(26);case 30:case"end":return t.stop()}}),t,null,[[1,23,26,30]])})));return function(e){return t.apply(this,arguments)}}(),[E,Z,C,j,T]),removeCartItems:(0,l.useCallback)(function(){var t=(0,a.Z)(s().mark((function t(e){var r,n,a,o,c,u,l,f,p,v,b,h,g;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.cartData,n=e.eventLabel,a=e.gridItems,o=e.isPrimary,c=void 0===o||o,u=e.itemsToRemove,l=void 0===u?[]:u,f=e.mutateCart,p=e.pageSection,v=e.routePathProps,b=e.withOptimisticUpdate,h=void 0===b||b,t.prev=1,h&&f((function(t){return B(B({},t),{},{items:U(t.items,l)})}),!1),g=(0,m.h2)({urlParams:{isPrimary:c}}).formattedUrl,t.next=6,D.jm.delete(g,{data:l.map((function(t){return{item_id:t.id,item_type:(0,w.rw)({asset:t})}}))});case 6:c&&j({cart:r,eventLabel:n,gridItems:a,items:l,pageSection:p}),v&&_.push.apply(_,(0,i.Z)(v)),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(1);case 12:return t.prev=12,t.next=15,(0,d.JG)(F({isPrimary:c}));case 15:return t.finish(12);case 16:case"end":return t.stop()}}),t,null,[[1,10,12,16]])})));return function(e){return t.apply(this,arguments)}}(),[_,j,U]),moveToSaveForLater:(0,l.useCallback)(function(){var t=(0,a.Z)(s().mark((function t(e){var n,a,i,o,u,l,d,p,v;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.eventLabel,a=e.itemsToMove,i=e.pageSection,o=e.primaryCart,u=e.savedForLaterCart,l=e.mutatePrimaryCart,d=e.mutateSavedForLaterCart,r({status:"",error:void 0}),c(!1),!((p=E({cartItems:u.items,itemsToAdd:a})).length>h.fv)){t.next=8;break}throw r({status:f.cM}),c(!0),new Error(q);case 8:return l((function(t){return B(B({},t),{},{items:U(t.items,a)})}),!1),d((function(t){return B(B({},t),{},{items:p})}),!1),v=(0,m.FB)({urlParams:{fromCartType:h.Yl,toCartType:h.d7}}).formattedUrl,t.t0=D.jm,t.t1=v,t.next=15,Z({items:a});case 15:return t.t2=t.sent,t.next=18,t.t0.post.call(t.t0,t.t1,t.t2);case 18:j({cart:o,eventLabel:n,items:a,pageSection:i});case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[E,Z,j,U]),moveToPrimary:(0,l.useCallback)(function(){var t=(0,a.Z)(s().mark((function t(e){var n,a,i,o,u,l;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.itemsToMove,a=e.primaryCart,i=e.mutatePrimaryCart,o=e.mutateSavedForLaterCart,r({status:"",error:void 0}),c(!1),!((u=E({cartItems:a.items,itemsToAdd:n})).length>h.fv)){t.next=8;break}throw r({status:f.cM}),c(!0),new Error(q);case 8:return o((function(t){return B(B({},t),{},{items:U(t.items,n)})}),!1),i((function(t){return B(B({},t),{},{items:u})}),!1),l=(0,m.FB)({urlParams:{fromCartType:h.d7,toCartType:h.Yl}}).formattedUrl,t.t0=D.jm,t.t1=l,t.next=15,Z({items:n});case 15:return t.t2=t.sent,t.next=18,t.t0.post.call(t.t0,t.t1,t.t2);case 18:C({cart:a,items:n});case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[E,Z,C,U]),addToCartStatus:e,setAddToCartStatus:r,isSizeLimitWarning:o}},N=function(t){var e=t.cartItems,r=(0,_.av)().data,a=(0,A.U)(),i=a.isLoading,o=(0,n.Z)(a,E),c=!r||i,s=function(t){var e=t.items;return null===e||void 0===e?void 0:e.some((function(t){return!t.hasCreditsRemaining}))}({items:e}),u=(0,O.ky)({items:e,isLoading:c,subscriptions:r,userCapabilities:o}),l=u.amountType,d=u.hasInsufficientSubscriptionCredits,m=u.insufficientAmount,f=u.hasLowDebitableBalance;return{amountType:l,isDebitableUser:(0,j.Kc)({userCapabilities:o}),userCanViewDebitableBalance:(0,j.LQ)({userCapabilities:o}),hasInsufficientCartItemsCredits:s,hasInsufficientSubscriptionCredits:d,insufficientAmount:m,hasLowDebitableBalance:f}}}}]);